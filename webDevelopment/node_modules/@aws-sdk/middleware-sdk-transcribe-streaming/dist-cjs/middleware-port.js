"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.websocketPortMiddlewareOptions = exports.websocketPortMiddleware = void 0;
const protocol_http_1 = require("@aws-sdk/protocol-http");
const websocketPortMiddleware = (options) => (next) => (args) => {
    var _a, _b;
    const { request } = args;
    if (protocol_http_1.HttpRequest.isInstance(request) && ((_b = (_a = options.requestHandler.metadata) === null || _a === void 0 ? void 0 : _a.handlerProtocol) === null || _b === void 0 ? void 0 : _b.includes("websocket"))) {
        request.hostname = `${request.hostname}:8443`;
        request.headers.host = request.hostname;
    }
    return next(args);
};
exports.websocketPortMiddleware = websocketPortMiddleware;
exports.websocketPortMiddlewareOptions = {
    name: "websocketPortMiddleware",
    tags: ["WEBSOCKET", "EVENT_STREAM", "PORT"],
    relation: "after",
    toMiddleware: "eventStreamHeaderMiddleware",
    override: true,
};
